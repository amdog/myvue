{"version":3,"sources":["src/bus.js"],"names":["Bus","options","_init","prototype","ops","$options","initstate","vm","opts","data","initdata","computed","initcomputed","watch","initwatch","_data","call","observe","Observer","keys","Object","i","length","key","value","reactive","d","k","v","defineProperty","get","set","newv"],"mappings":";;;;AAAA,SAASA,GAAT,CAAaC,OAAb,EAAqB;AACjB,OAAKC,KAAL,CAAWD,OAAX;;AACJ;AACC;;AACDD,GAAG,CAACG,SAAJ,CAAcD,KAAd,GAAoB,UAACE,GAAD,EAAO;AACvB,EAAA,KAAI,CAACC,QAAL,GAAcD,GAAd;AACAE,EAAAA,SAAS,CAAC,KAAD,CAAT;AACH,CAHD;;AAKA,SAASA,SAAT,CAAmBC,EAAnB,EAAsB;AAClB,MAAIC,IAAI,GAACD,EAAE,CAACF,QAAZ;;AACA,MAAGG,IAAI,CAACC,IAAR,EAAa;AACTC,IAAAA,QAAQ,CAACH,EAAD,CAAR;AACH;;AACD,MAAGC,IAAI,CAACG,QAAR,EAAiB;AACbC,IAAAA,YAAY;AACf;;AACD,MAAIJ,IAAI,CAACK,KAAT,EAAe;AACXC,IAAAA,SAAS;AACZ;AACJ;;AACD,SAASJ,QAAT,CAAkBH,EAAlB,EAAqB;AACjB,MAAIE,IAAI,GAAGF,EAAE,CAACF,QAAH,CAAYI,IAAvB;;AACA,MAAG,OAAOA,IAAP,IAAe,UAAlB,EAA6B;AACzB;AACAF,IAAAA,EAAE,CAACQ,KAAH,GAASN,IAAI,CAACO,IAAL,CAAUT,EAAV,CAAT;AACH,GAHD,MAGK;AACDA,IAAAA,EAAE,CAACQ,KAAH,GAASN,IAAI,IAAI,EAAjB;AACH;;AACDQ,EAAAA,OAAO,CAACV,EAAE,CAACQ,KAAJ,CAAP;AACH;;AAED,SAASE,OAAT,CAAiBR,IAAjB,EAAsB;AAClB,MAAG,QAAOA,IAAP,KAAe,QAAlB,EAA2B;AACvB,QAAIS,QAAJ,CAAaT,IAAb;AACH,GAFD,MAGI;AACA;AACH;AACJ;;AACD,SAASS,QAAT,CAAkBT,IAAlB,EAAuB;AACnB,MAAIU,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYV,IAAZ,CAAX;;AACA,OAAI,IAAIY,CAAC,GAAC,CAAV,EAAYA,CAAC,GAACF,IAAI,CAACG,MAAnB,EAA0BD,CAAC,EAA3B,EAA8B;AAC1B,QAAIE,GAAG,GAACJ,IAAI,CAACE,CAAD,CAAZ;AACA,QAAIG,KAAK,GAACf,IAAI,CAACc,GAAD,CAAd;AACAE,IAAAA,QAAQ,CAAChB,IAAD,EAAMc,GAAN,EAAUC,KAAV,CAAR;AACH;AACJ;;AAED,SAASC,QAAT,CAAkBC,CAAlB,EAAoBC,CAApB,EAAsBC,CAAtB,EAAwB;AACpB;AACAR,EAAAA,MAAM,CAACS,cAAP,CAAsBH,CAAtB,EAAwBC,CAAxB,EAA0B;AACtBG,IAAAA,GADsB,iBACjB;AACD,aAAOF,CAAP;AACH,KAHqB;AAItBG,IAAAA,GAJsB,eAIlBC,IAJkB,EAIb;AACL,UAAGA,IAAI,KAAKJ,CAAZ,EAAe;AACX;AACH;;AACDX,MAAAA,OAAO,CAACe,IAAD,CAAP;AACAJ,MAAAA,CAAC,GAACI,IAAF;AACH;AAVqB,GAA1B;AAYH;;AAED,SAASlB,SAAT,GAAoB,CAEnB;;AACD,SAASF,YAAT,GAAuB,CAEtB","file":"bus.42e5b723.js","sourceRoot":"..","sourcesContent":["function Bus(options){\r\n    this._init(options)\r\nreturn \r\n}\r\nBus.prototype._init=(ops)=>{\r\n    this.$options=ops\r\n    initstate(this)\r\n}\r\n\r\nfunction initstate(vm){\r\n    let opts=vm.$options\r\n    if(opts.data){\r\n        initdata(vm)\r\n    }\r\n    if(opts.computed){\r\n        initcomputed()\r\n    }\r\n    if (opts.watch){\r\n        initwatch()\r\n    }\r\n}\r\nfunction initdata(vm){\r\n    let data = vm.$options.data\r\n    if(typeof data == 'function'){\r\n        //data里面的this指向vm实例 this.xxx=xx\r\n        vm._data=data.call(vm)\r\n    }else{\r\n        vm._data=data || {}\r\n    }\r\n    observe(vm._data)\r\n}\r\n\r\nfunction observe(data){\r\n    if(typeof data == 'object'){\r\n        new Observer(data)\r\n    }\r\n    else{\r\n        return \r\n    }\r\n}\r\nfunction Observer(data){\r\n    let keys = Object.keys(data)\r\n    for(let i=0;i<keys.length;i++){\r\n        let key=keys[i]\r\n        let value=data[key]\r\n        reactive(data,key,value)\r\n    }\r\n}\r\n\r\nfunction reactive(d,k,v){\r\n    //Object.defineProperty(倾听的数据，倾听的键，配置{get,set})\r\n    Object.defineProperty(d,k,{\r\n        get(){\r\n            return v\r\n        },\r\n        set(newv){\r\n            if(newv === v ){\r\n                return \r\n            }\r\n            observe(newv)\r\n            v=newv\r\n        }\r\n    })\r\n}\r\n\r\nfunction initwatch(){\r\n\r\n}\r\nfunction initcomputed(){\r\n\r\n}\r\n"]}